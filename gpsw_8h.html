<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CiFEr: include/cifer/abe/gpsw.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CiFEr
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_3186075824eb6c6fc16d275650bc36ef.html">cifer</a></li><li class="navelem"><a class="el" href="dir_0d628d3c9b21a09631269a5f84e03143.html">abe</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">gpsw.h File Reference<div class="ingroups"><a class="el" href="group__abe.html">ABE schemes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Key policy attribute based scheme.  
<a href="#details">More...</a></p>

<p><a href="gpsw_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a2b9af4fdadb9da0c75881d693771def0"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a2b9af4fdadb9da0c75881d693771def0">cfe_gpsw</a></td></tr>
<tr class="separator:a2b9af4fdadb9da0c75881d693771def0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ed7f5bcf98a310a45d73c4e09fda328"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a2ed7f5bcf98a310a45d73c4e09fda328">cfe_gpsw_pub_key</a></td></tr>
<tr class="separator:a2ed7f5bcf98a310a45d73c4e09fda328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68f1add7678f301a29a0cba3cc9af54d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a68f1add7678f301a29a0cba3cc9af54d">cfe_gpsw_cipher</a></td></tr>
<tr class="separator:a68f1add7678f301a29a0cba3cc9af54d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64c0f91a28e445cf6bc08ce3cdf7fd3b"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a64c0f91a28e445cf6bc08ce3cdf7fd3b">cfe_gpsw_key</a></td></tr>
<tr class="separator:a64c0f91a28e445cf6bc08ce3cdf7fd3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6e7804ad7be4f0f426654882453acd35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a6e7804ad7be4f0f426654882453acd35">cfe_gpsw_init</a> (<a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw, size_t l)</td></tr>
<tr class="separator:a6e7804ad7be4f0f426654882453acd35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3b55cbe5442ff3a8f7dc89b879dfbc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#af3b55cbe5442ff3a8f7dc89b879dfbc7">cfe_gpsw_master_keys_init</a> (<a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *pk, <a class="el" href="structcfe__vec.html">cfe_vec</a> *sk, <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw)</td></tr>
<tr class="separator:af3b55cbe5442ff3a8f7dc89b879dfbc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95cb32b71804da1dfadc19d1acfd46e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a95cb32b71804da1dfadc19d1acfd46e3">cfe_gpsw_generate_master_keys</a> (<a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *pk, <a class="el" href="structcfe__vec.html">cfe_vec</a> *sk, <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw)</td></tr>
<tr class="separator:a95cb32b71804da1dfadc19d1acfd46e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f9f8bc1f5dbf5810bbca70a7f2c8faa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a1f9f8bc1f5dbf5810bbca70a7f2c8faa">cfe_gpsw_cipher_init</a> (<a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *cipher, size_t num_attrib)</td></tr>
<tr class="separator:a1f9f8bc1f5dbf5810bbca70a7f2c8faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d002466f4be5189838669cd047c158"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#ab5d002466f4be5189838669cd047c158">cfe_gpsw_encrypt</a> (<a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *cipher, <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw, FP12_BN254 *msg, int *gamma, size_t num_attrib, <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *pk)</td></tr>
<tr class="separator:ab5d002466f4be5189838669cd047c158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc397b9fa612bc4241ebd919af0198b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#adc397b9fa612bc4241ebd919af0198b2">cfe_gpsw_key_init</a> (<a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a> *policy_key, <a class="el" href="structcfe__msp.html">cfe_msp</a> *msp)</td></tr>
<tr class="separator:adc397b9fa612bc4241ebd919af0198b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e37b643bfb756fc65ffd99dd262dfbe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a2e37b643bfb756fc65ffd99dd262dfbe">cfe_gpsw_generate_policy_key</a> (<a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a> *key, <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw, <a class="el" href="structcfe__msp.html">cfe_msp</a> *msp, <a class="el" href="structcfe__vec.html">cfe_vec</a> *sk)</td></tr>
<tr class="separator:a2e37b643bfb756fc65ffd99dd262dfbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc884c6053ce0253e0e090b1b277dba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a4cc884c6053ce0253e0e090b1b277dba">cfe_gpsw_rand_vec_const_sum</a> (<a class="el" href="structcfe__vec.html">cfe_vec</a> *v, mpz_t y, mpz_t p)</td></tr>
<tr class="separator:a4cc884c6053ce0253e0e090b1b277dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acabc065ee73a5583466186527ac47e37"><td class="memItemLeft" align="right" valign="top">cfe_error&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#acabc065ee73a5583466186527ac47e37">cfe_gpsw_decrypt</a> (FP12_BN254 *res, <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *cipher, <a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a> *key, <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw)</td></tr>
<tr class="separator:acabc065ee73a5583466186527ac47e37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e29f5760cc15eb2c7fc8df0da02c507"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a5e29f5760cc15eb2c7fc8df0da02c507">cfe_gpsw_free</a> (<a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *gpsw)</td></tr>
<tr class="separator:a5e29f5760cc15eb2c7fc8df0da02c507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae01cd257c0e73b1c9a17c7af6bf226f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#ae01cd257c0e73b1c9a17c7af6bf226f5">cfe_gpsw_pub_key_free</a> (<a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *pk)</td></tr>
<tr class="separator:ae01cd257c0e73b1c9a17c7af6bf226f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3d0903dc70f026b50110c7c3e21c1da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#ae3d0903dc70f026b50110c7c3e21c1da">cfe_gpsw_cipher_free</a> (<a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *cipher)</td></tr>
<tr class="separator:ae3d0903dc70f026b50110c7c3e21c1da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dea66eae54da7bb8f1fecd67bdec588"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpsw_8h.html#a3dea66eae54da7bb8f1fecd67bdec588">cfe_gpsw_key_free</a> (<a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a> *key)</td></tr>
<tr class="separator:a3dea66eae54da7bb8f1fecd67bdec588"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Key policy attribute based scheme. </p>
<p>This is a key policy (KP) attribute based (ABE) scheme based on Goyal, Pandey, Sahai, Waters: "Attribute-Based Encryption for
Fine-Grained Access Control of Encrypted Data" We abbreviated it GPSW scheme to honor the authors. This scheme enables distribution of keys with associated boolean expression (policy) and encrypting ciphertext with associated set of attributes. A key can decrypt a ciphertext if the associated attributes satisfy the policy. This scheme is a PUBLIC-KEY scheme - no master secret key is needed to encrypt the messages. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="a2b9af4fdadb9da0c75881d693771def0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b9af4fdadb9da0c75881d693771def0">&#9670;&nbsp;</a></span>cfe_gpsw</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> represents the GPSW scheme. </p>

</div>
</div>
<a id="a2ed7f5bcf98a310a45d73c4e09fda328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ed7f5bcf98a310a45d73c4e09fda328">&#9670;&nbsp;</a></span>cfe_gpsw_pub_key</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> represents the public key for the GPSW scheme. </p>

</div>
</div>
<a id="a68f1add7678f301a29a0cba3cc9af54d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68f1add7678f301a29a0cba3cc9af54d">&#9670;&nbsp;</a></span>cfe_gpsw_cipher</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> represents the ciphertext structure for the GPSW scheme. </p>

</div>
</div>
<a id="a64c0f91a28e445cf6bc08ce3cdf7fd3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64c0f91a28e445cf6bc08ce3cdf7fd3b">&#9670;&nbsp;</a></span>cfe_gpsw_key</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a> <a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> represents the key structure with all the keys corresponding owned attributes and is needed for the decryption in the GPSW scheme. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6e7804ad7be4f0f426654882453acd35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e7804ad7be4f0f426654882453acd35">&#9670;&nbsp;</a></span>cfe_gpsw_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Configures a new instance of the scheme.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpsw</td><td>A pointer to an uninitialized struct representing the scheme </td></tr>
    <tr><td class="paramname">l</td><td>The number of attributes that can be used in the scheme. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af3b55cbe5442ff3a8f7dc89b879dfbc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3b55cbe5442ff3a8f7dc89b879dfbc7">&#9670;&nbsp;</a></span>cfe_gpsw_master_keys_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_master_keys_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__vec.html">cfe_vec</a> *&#160;</td>
          <td class="paramname"><em>sk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the structs which represent the master public and master secret key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pk</td><td>A pointer to an uninitialized <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> struct </td></tr>
    <tr><td class="paramname">sk</td><td>A pointer to an uninitialized vector </td></tr>
    <tr><td class="paramname">gpsw</td><td>A pointer to an initialized struct representing the scheme </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a95cb32b71804da1dfadc19d1acfd46e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95cb32b71804da1dfadc19d1acfd46e3">&#9670;&nbsp;</a></span>cfe_gpsw_generate_master_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_generate_master_keys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *&#160;</td>
          <td class="paramname"><em>pk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__vec.html">cfe_vec</a> *&#160;</td>
          <td class="paramname"><em>sk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generates master secret and public key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pk</td><td>A pointer to a <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> struct which represents the master public key </td></tr>
    <tr><td class="paramname">sk</td><td>A pointer to a vector which represents the master public key </td></tr>
    <tr><td class="paramname">gpsw</td><td>A pointer to an initialized struct representing the scheme </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1f9f8bc1f5dbf5810bbca70a7f2c8faa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f9f8bc1f5dbf5810bbca70a7f2c8faa">&#9670;&nbsp;</a></span>cfe_gpsw_cipher_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_cipher_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_attrib</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the struct which represents the ciphertext.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipher</td><td>A pointer to an uninitialized <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> struct </td></tr>
    <tr><td class="paramname">num_attrib</td><td>The number of attributes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab5d002466f4be5189838669cd047c158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5d002466f4be5189838669cd047c158">&#9670;&nbsp;</a></span>cfe_gpsw_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_encrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FP12_BN254 *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_attrib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *&#160;</td>
          <td class="paramname"><em>pk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function takes as an input a message given as a string, gamma a set of attributes that can be latter used in a decryption policy, and a public key. It creates an encryption of the message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipher</td><td>A pointer to a <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> struct, the ciphertext will be saved here </td></tr>
    <tr><td class="paramname">gpsw</td><td>A pointer to an initialized struct representing the scheme </td></tr>
    <tr><td class="paramname">msg</td><td>An element of FP12_BN254 representing the message </td></tr>
    <tr><td class="paramname">gamma</td><td>A pointer to an array of integers defining which attributes can be used for the decryption policy </td></tr>
    <tr><td class="paramname">num_attrib</td><td>Length of gamma </td></tr>
    <tr><td class="paramname">pk</td><td>A pointer to an initialized struct representing the public key </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adc397b9fa612bc4241ebd919af0198b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc397b9fa612bc4241ebd919af0198b2">&#9670;&nbsp;</a></span>cfe_gpsw_key_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_key_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a> *&#160;</td>
          <td class="paramname"><em>policy_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__msp.html">cfe_msp</a> *&#160;</td>
          <td class="paramname"><em>msp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the cfe_gpsw_keys struct which represents the keys for the decryption.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">policy_key</td><td>A pointer to an uninitialized cfe_gpsw_keys struct </td></tr>
    <tr><td class="paramname">msp</td><td>A pointer to an initialized struct representing the MSP policy </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2e37b643bfb756fc65ffd99dd262dfbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e37b643bfb756fc65ffd99dd262dfbe">&#9670;&nbsp;</a></span>cfe_gpsw_generate_policy_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_generate_policy_key </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__msp.html">cfe_msp</a> *&#160;</td>
          <td class="paramname"><em>msp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__vec.html">cfe_vec</a> *&#160;</td>
          <td class="paramname"><em>sk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function given a monotone span program (MSP) and the vector of secret keys produces a keys needed for the decryption. In particular, the key can be used to decrypt a ciphertext if and only if the set of attributes attached to the ciphertext satisfy the policy associated to the key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>A pointer to a vector of elements of the elliptic curve, the keys will be saved here </td></tr>
    <tr><td class="paramname">gpsw</td><td>A pointer to an initialized struct representing the scheme </td></tr>
    <tr><td class="paramname">msp</td><td>A pointer to an initialized struct representing the MSP policy </td></tr>
    <tr><td class="paramname">sk</td><td>A pointer to an initialized struct representing the secret key </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4cc884c6053ce0253e0e090b1b277dba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cc884c6053ce0253e0e090b1b277dba">&#9670;&nbsp;</a></span>cfe_gpsw_rand_vec_const_sum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_rand_vec_const_sum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__vec.html">cfe_vec</a> *&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mpz_t&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mpz_t&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A helping function used in generate_policy_keys. </p>

</div>
</div>
<a id="acabc065ee73a5583466186527ac47e37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acabc065ee73a5583466186527ac47e37">&#9670;&nbsp;</a></span>cfe_gpsw_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cfe_error cfe_gpsw_decrypt </td>
          <td>(</td>
          <td class="paramtype">FP12_BN254 *&#160;</td>
          <td class="paramname"><em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The function takes as an input a cipher and keys and tries to decrypt the cipher. If the keys were properly generated, the set of attributes attached to the ciphertext satisfy the policy associated to the key. If this is not possible, i.e. keys are insufficient, the function returns the corresponding error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">res</td><td>An element of FP12_BN254, the decryption will be saved here </td></tr>
    <tr><td class="paramname">cipher</td><td>A pointer to an initialized struct representing the ciphertext </td></tr>
    <tr><td class="paramname">key</td><td>A pointer to an initialized struct representing the keys for the decryption </td></tr>
    <tr><td class="paramname">gpsw</td><td>A pointer to an initialized struct representing the scheme </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

</div>
</div>
<a id="a5e29f5760cc15eb2c7fc8df0da02c507"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e29f5760cc15eb2c7fc8df0da02c507">&#9670;&nbsp;</a></span>cfe_gpsw_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> *&#160;</td>
          <td class="paramname"><em>gpsw</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpsw</td><td>A pointer to an instance of the scheme (<em>initialized</em> <a class="el" href="structcfe__gpsw.html">cfe_gpsw</a> struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae01cd257c0e73b1c9a17c7af6bf226f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae01cd257c0e73b1c9a17c7af6bf226f5">&#9670;&nbsp;</a></span>cfe_gpsw_pub_key_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_pub_key_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> *&#160;</td>
          <td class="paramname"><em>pk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pk</td><td>A pointer to an instance of the public key (<em>initialized</em> <a class="el" href="structcfe__gpsw__pub__key.html">cfe_gpsw_pub_key</a> struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae3d0903dc70f026b50110c7c3e21c1da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3d0903dc70f026b50110c7c3e21c1da">&#9670;&nbsp;</a></span>cfe_gpsw_cipher_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_cipher_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> *&#160;</td>
          <td class="paramname"><em>cipher</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cipher</td><td>A pointer to an instance of the ciphertext (<em>initialized</em> <a class="el" href="structcfe__gpsw__cipher.html">cfe_gpsw_cipher</a> struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a3dea66eae54da7bb8f1fecd67bdec588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dea66eae54da7bb8f1fecd67bdec588">&#9670;&nbsp;</a></span>cfe_gpsw_key_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cfe_gpsw_key_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcfe__gpsw__key.html">cfe_gpsw_key</a> *&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees the memory occupied by the struct members. It does not free memory occupied by the struct itself.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>A pointer to an instance of the decryption keys (<em>initialized</em> cfe_gpsw_keys struct) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
